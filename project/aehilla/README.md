# README

LAST UPDATED: 2020-11-23  
ORGANIZATION: spatial-data-discovery  
REPOSITORY: ay2021-1  
FOLDER: project/aehilla

## Files

### Scripts
* [NetCDF_processing.py](https://github.com/spatial-data-discovery/ay2021-1/project/aehilla/NetCDF_processing.py)
* [elexdate_webscraper.py](https://github.com/spatial-data-discovery/ay2021-1/project/aehilla/elexdate_webscraper.py)

### Data
* [us_elex_dates_test2.csv](https://github.com/spatial-data-discovery/ay2021-1/project/aehilla/Data/us_elex_dates_test2.csv)
* [geoboundariesSSCGS-3_0_0-USA-ADM0.shp](https://github.com/spatial-data-discovery/ay2021-1/project/aehilla/Data/USA_shapefile/geoboundariesSSCGS-3_0_0-USA-ADM0.shp)
* [idea_data.csv](https://github.com/spatial-data-discovery/ay2021-1/project/aehilla/Data/webscraper_input/idea_data.csv)
* [Rainf_daily_WFDEI_CRU_198011.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_198011.nc)
* [Rainf_daily_WFDEI_CRU_198211.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_198211.nc)
* [Rainf_daily_WFDEI_CRU_198411.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_198411.nc)
* [Rainf_daily_WFDEI_CRU_198611.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_198611.nc)
* [Rainf_daily_WFDEI_CRU_198811.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_198811.nc)
* [Rainf_daily_WFDEI_CRU_199011.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_199011.nc)
* [Rainf_daily_WFDEI_CRU_199211.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_199211.nc)
* [Rainf_daily_WFDEI_CRU_199411.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_199411.nc)
* [Rainf_daily_WFDEI_CRU_199611.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_199611.nc)
* [Rainf_daily_WFDEI_CRU_199811.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_199811.nc)
* [Rainf_daily_WFDEI_CRU_200011.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_200011.nc)
* [Rainf_daily_WFDEI_CRU_200211.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_200211.nc)
* [Rainf_daily_WFDEI_CRU_200411.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_200411.nc)
* [Rainf_daily_WFDEI_CRU_200611.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_200611.nc)
* [Rainf_daily_WFDEI_CRU_200811.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_200811.nc)
* [Rainf_daily_WFDEI_CRU_201011.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_201011.nc)
* [Rainf_daily_WFDEI_CRU_201211.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_201211.nc)
* [Rainf_daily_WFDEI_CRU_201411.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_201411.nc)
* [Rainf_daily_WFDEI_CRU_201611.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_201611.nc)
* [Rainf_daily_WFDEI_CRU_201811.nc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Data/WFDEI_files/Rainf_daily_WFDEI_CRU_201811.nc)

### Output files
* [rainfall1980.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1980.asc)
* [rainfall1982.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1982.asc)
* [rainfall1984.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1984.asc)
* [rainfall1986.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1986.asc)
* [rainfall1988.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1988.asc)
* [rainfall1990.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1990.asc)
* [rainfall1992.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1992.asc)
* [rainfall1994.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1994.asc)
* [rainfall1996.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1996.asc)
* [rainfall1998.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall1998.asc)
* [rainfall2000.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2000.asc)
* [rainfall2002.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2002.asc)
* [rainfall2004.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2004.asc)
* [rainfall2006.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2006.asc)
* [rainfall2008.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2008.asc)
* [rainfall2010.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2010.asc)
* [rainfall2012.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2012.asc)
* [rainfall2014.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2014.asc)
* [rainfall2016.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2016.asc)
* [rainfall2018.asc](https://github.com/spatial-data-discovery/ay2021-1/blob/master/project/aehilla/Output/rainfall2018.asc)

# elexdate_webscraper.py

## Instructions:

This script is meant to parse US election days from Wikipedia pages on each elction. 
It uses the election years from the input file idea_data.csv to obtain a list of election years.
It then performs a google search to identify the address of the corresponding Wikipedia page. 
It uses the Wikipedia api to pull the content of the page, and then uses datetime.parser to find the election date. 
It appends the election dates to a pandas dataframe, then creates a separate column for just the day. 
It saves the output table to a new .csv.

To run this script, load the input file (idea_data.csv) to the local directory, make sure to have the needed packages installed, and then run from the command line or a Jupyter notebook. 

# NetCDF_processing.py

## Instructions:

This script converts input netCDF files of satellite precipitation rainfall globally to single day rasters for each election day in the United States, from 1980 to 2018.
The input files contain one month of data, for every November in the time span. 
The script uses the arcpy package to first convert the netCDFs to raster files and select the correct day of the election, then project the raster to WGS 84, then clip the raster to the US using the US boundaries shapefile from Geoboundaries.
The clipped raster is converted to an ASCII file and saved to the local directory. 
The script also saves the raster as an ArcGIS raster, to the local geodatabase. 

To run this script, create a new ArcGIS Pro project, and add a new notebook. 
Make sure you have all needed packages installed, then copy and paste the code into the notebook and run the cell.
Or, run from the command line using the instructions from [esri](https://pro.arcgis.com/en/pro-app/arcpy/get-started/installing-python-for-arcgis-pro.htm) under 'From a command prompt.'

# Required packages

## for netCDF_processing
* [pandas](https://pandas.pydata.org/)
* [arcpy](https://pro.arcgis.com/en/pro-app/get-started/install-and-sign-in-to-arcgis-pro.htm)
* [glob](https://docs.python.org/3/library/glob.html)
* [os](https://pypi.org/project/os-sys/)
* [traceback](https://docs.python.org/3/library/traceback.html)

## for elexdate_webscraper
* [BeautifulSoup](https://pypi.org/project/beautifulsoup4/)
* [requests](https://pypi.org/project/requests/)
* [google](https://pypi.org/project/google/)
* [regex](https://pypi.org/project/regex/)
* [pandas](https://pandas.pydata.org/)
* [datetime](https://pypi.org/project/DateTime/)
* [dateutil.parser](https://pypi.org/project/python-dateutil/)
* [urllib.request](https://docs.python.org/3/library/urllib.request.html)
* [wikipedia](https://pypi.org/project/wikipedia/)
* [numpy](https://numpy.org/)
* [google-search](https://pypi.org/project/googlesearch-python/)


# Data Sources

## Election data

* Provider: [International IDEA](https://www.idea.int/data-tools)
* [Download](https://www.idea.int/data-tools/data/voter-turnout)
* Years covered: 1945 to 2020
* Created in 2002

* Variables: 
    * Country
    * Election type
    * Year
    * Voter Turnout
    * Total vote
    * Registration
    * VAP Turnout
    * Voting age population
    * Population
    * Invalid votes
    * Compulsory voting
    
* Variables used:
    * Country
    * Year
    
* Years used: 1980 to 2018
    
* Contact:
    * International Institute for Democracy and Electoral Assistance (International IDEA)
    * Strömsborg, SE-103 34, Stockholm, Sweden
    * Tel: +46 8 698 37 00
    

## USA Boundaries

* Provider: [Geoboundaries](https://www.geoboundaries.org/)
* [Download](https://www.geoboundaries.org/downloadSimple.html)
* Created in 2017

* Variables:
    * US ADM0

* Contact: 
    * team@geoboundaries.org
    * (757) 221-1970
    * geoLab, Applied Science, 540 Landrum Drive, Williamsburg, VA 23185
    

## Precipitation data

* Provider: [WFDEI Meteorological Forcing Data](https://rda.ucar.edu/datasets/ds314.2/)
* Full title: The WFDEI meteorological forcing data set: WATCH Forcing Data methodology applied to ERA-Interim reanalysis data.
* Created in 2018
* [Download](ftp://rfdata:forceDATA@ftp.iiasa.ac.at/WFDEI/)

* Variables:
    * Tair_WFDEI Tair 2 m instantaneous air temperature K
    * Wind_WFDEI Wind 10 m instantaneous wind speed m/s
    * PSurf_WFDEI PSurf Instantaneous surface pressure Pa
    * Qair_WFDEI Qair 2 m instantaneous specific humidity kg/kg
    * LWdown_WFDEI LWdown Long-wave downwards surface radiation flux (average over previous 3 hours) W/m2
    * SWdown_WFDEI SWdown Long-wave downwards surface radiation flux (average over previous 3 hours) W/m2
    * Rainf_WFDEI_GPCC Rainf Rainfall rate, bias corrected with GPCCv5 data (v6 for 2010) and gauge “catch corrected” (average over previous 3 hours) kg/m2     
    * Snowf_WFDEI_GPCC Snowf Snowfall rate, bias corrected with GPCCv5 data (v6 for 2010) and gauge “catch corrected”  (average over previous 3 hours) kg/m2
    * Rainf_WFDEI_CRU Rainf Rainfall rate, bias corrected with CRU TS3.101 data (TS3.21 for 2010-2012) and gauge “catch corrected” (average over previous 3 hrs) kg/m2
    * Snowf_WFDEI_CRU Snowf Snowfall rate, bias corrected with CRU TS3.101 data (TS3.21 for 2010-2012) and gauge “catch corrected” (average over previous 3 hrs) kg/m2

* Variables used:
    * Rainf_WFDEI_CRU Rainf Rainfall rate, bias corrected with CRU TS3.101 data (TS3.21 for 2010-2012) and gauge “catch corrected” (average over previous 3 hrs) kg/m2
    
* Years covered: 1979 - 2018
* Years used: 1980 -2018
    
* Contact: 
    * graham.weedon@metoffice.gov.uk
    * gianpaolo.balsamo@ecmwf.int
    * smgomes@fc.ul.pt